<h1>Docker Compose on my T430</h1>

<p>In my <a class="blog_prev" href="./prev" title="Previous blog post">previous post</a> I finished the <a href="https://www.docker.com/" title="The Docker container platform">Docker</a> <a href="https://docs.docker.com/compose/overview/" title="Compose is a tool for defining and running multi-container Docker applications">Compose</a> implementation of my <a href="">Node.js</a> <a href="https://directplus.documentation.dnb.com/" title="The D&amp;B Direct+ API">D&amp;B Direct+</a> application in the cloud. I will leave the application running in the cloud for quick access &amp; rudimentary stability testing. As mentioned before I have a preference for developing new code on my <a href="#" title="My new (second-hand) hardware" onclick="navBlog.anchorAction(event, 'ibm_t430_pt1.xhtml')">Lenovo T430</a> anyway. Previously I used <a href="#" title="Creating an Ubuntu 18.04 VM" onclick="navBlog.anchorAction(event, 'ibm_t430_pt3.xhtml')">Virtual Machines</a> for this purpose but now, with all my positive experiences working in a containerized environment, my aim is to switch to Docker on my garage sale laptop as well.</p>

<p>I have posted about how-to install <a href="#" title="Getting started with Docker" onclick="navBlog.anchorAction(event, 'docker_pt1.xhtml')">Docker</a> and <a href="#" title="Docker Compose lift-off" onclick="navBlog.anchorAction(event, 'dkr_compose_pt1.xhtml')">Docker Compose</a> in the cloud before. This time the install will be on a more tangible piece of kit: <img src="/dev/blog/imgs/look_at_the_dust.jpg" alt="My 2nd hand Lenove T430" style="margin:1.0em auto" /></p>

<p>I even decided to start completely from scratch:</p>
<ol>
   <li>So, first off, I repeated the steps described in <a href="#" title="Installing Ubuntu 18.04" onclick="navBlog.anchorAction(event, 'ibm_t430_pt2.xhtml')">this blog post</a> to deploy a fresh copy of <a href="https://www.ubuntu.com/download/desktop" title="Download Ubuntu Desktop">Ubuntu 18.04</a> on my laptop. However, this time around, I chose "New York" as my location where I chose "Amsterdam" before. The rationale driving this decision was that I wanted to avoid all kinds of issues related to (what I suspect is) an incomplete Dutch <a href="https://en.wikipedia.org/wiki/Locale_(computer_software)" title="Wiki locale">locale</a>.</li>
   <li>With the operating system in place I created <a href="https://gist.github.com/hdr1001/3010dbbe549707520a19984245d46af5" title="OpenSSL working directory">a working directory</a> in order to generate self-signed SSL certificates.</li>
   <li>I always update the <i>dir</i> entry in section <i>CA_default</i> of file <i>openssl.cnf</i> to: <code>dir = ./</code>When following these instructions step-by-step please remember to make directory <i>~/OpenSSL</i> the active directory when creating the SSL certificates!</li>
   <li>Next I actually produced the <a href="https://gist.github.com/hdr1001/acfc52cc39e344723d6fd9e26e49b6a3" title="CA SSL certificate">certification authority</a>, <a href="https://gist.github.com/hdr1001/6f080655ee64e1ea57edc77da97e69de" title="Server SSL certificate">server</a> &amp; <a href="https://gist.github.com/hdr1001/3ef7fe72ea2e5eba926b3c2a3afed124" title="Client SSL certificate">client</a> certificates.</li>
   <li>For the foundation of the stack only three additional pieces of software are needed: <ul><li>Docker (execute steps 1 &amp; 2 of <a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-on-ubuntu-18-04" title="How To Install and Use Docker on Ubuntu 18.04">this tutorial</a>),</li><li>Docker Compose (<i>sudo apt install docker-compose</i>) &amp;</li><li> Subversion (<i>sudo apt install subversion</i>)</li></ul></li>
   <li>It is my preference to create a directory dev for my projects: <code>mkdir ~/dev &amp;&amp; cd $_</code></li>
   <li>Finally I could <a href="https://gist.github.com/hdr1001/1536299d7732087af52919cdfa9c11f9" title="Deploy &amp; run D&amp;B Direct+ dev stack ">deploy &amp; run</a> my Dockerized dev stack &amp; Node.js JavaScript code on my T430.</li>
</ol>

<p>The entire job went off without a hitch. I could immediately access the application (after importing the client certificate in my laptop's Firefox browser) which was now running on the localhost:<img src="/dev/blog/imgs/dnb_dpl_localhost.png" alt="Containerized application on local host" style="margin:1.0em auto" /></p>

<p>The moment I reach this stage I always verify whether <a href="https://help.ubuntu.com/community/UFW" title="Uncomplicated FireWall">UFW</a> is enabled. I double check if all incoming ports, except the one for SSH, are closed because on this machine I only want to do local testing. More on the Uncomplicated FireWall in <a href="#" title="Previous post firewall configuration" onclick="navBlog.anchorAction(event, 'platform_pt7.xhtml')">this post</a>.</p>
 
<p><a href="https://www.postgresql.org/" title="The World's Most Advanced Open Source Relational Database">PostgreSQL</a> is a component of my dev stack. I use <a href="https://www.pgadmin.org/" title="Open Source admin and dev platform for PostgreSQL">pgAdmin</a> for PostgreSQL administration and application development purposes. The thing is that I do not expose an external port on my database Docker container. That makes it hard to connect to the server using pgAdmin. With the command below the IP address of the relevant container can be determined and this information can then be used, in the New Server Registration screen, as entry for the Host connection parameter.</p>

<script src="https://gist.github.com/hdr1001/5ca8f5191f3fad94307a1252e468c3e6.js" type="text/javascript"></script>

<p>The first programming I did on my newly configured T430 was to resolve an issue which had been on my to-do list for some time. Up until now file <a href="http://hdr.is-a-geek.com/svn/dnb_dpl_v2/node/src/dnb_dpl_objs.js?p=8" title="Rev 8 of my D&amp;B Direct+ objects">dnb_dpl_objs.js</a> included a number of SQL SELECT, INSERT &amp; UPDATE statements which made the code vulnerable to <a href="https://www.owasp.org/index.php/SQL_Injection" title="SQL injection">SQL injection attacks</a>. To guard against this a simple but effective first line of defense is to use <a href="http://bit.ly/2Slsqsk" title="Prepared statements">prepared statements</a> instead. These are included as of <a href="http://hdr.is-a-geek.com/svn/dnb_dpl_v2/node/src/dnb_dpl_objs.js?p=9" title="Rev 9 of my D&amp;B Direct+ objects">revision 9</a>.</p>
