<h1>Don't break the back button! (pt. I)</h1>

<p>My blog is made-up of a framework &amp; content. While navigating the blog the framework remains static whereas the content is loaded dynamically. Up until recently the supporting <a href="https://hdr.is-a-geek.com/dev/blog/js/a2blog_main.js" title="Blog JavaScript code">JavaScript code</a> contained just two functions to facilitate navigating the blog: (1) a function for handling menu interactions and (2) a function for handling links between individual posts. Unfortunately, as so many <a href="https://www.w3schools.com/xml/ajax_intro.asp" title="w3schools, AJAX intro">AJAX</a> applications do, the application broke the back button. This was an item on my to-do list for some time because this kind of application behaviour annoys me to no end. A simple Google search led me to an article titled <a href="https://www.rdeeson.com/weblog/113/going-back-in-history-with-ajax-and-html5" title="Going Back in History with AJAX and HTML5">"Going Back in History with AJAX and HTML5"</a>. Reading the article my impression was that fixing the back (&amp; forward) button(s) would be simple. In practice however things proved to be a bit more challenging.</p>

<p>An HTTP GET request for a particular blog post is initially picked up by Apache and, via a handler, routed to an <a href="https://hdr.is-a-geek.com/dev/blog/c/a2blog_main.c" title="My Apache blog module">Apache module</a> written in C. This module assembles the framework &amp; content and returns a (X)HTML page to the client. The head section of the page contains a reference to the JavaScript code in file <a href="https://hdr.is-a-geek.com/dev/blog/js/a2blog_main.js" title="Blog JavaScript code">a2blog_main.js</a>. <code>&lt;script src="/dev/blog/js/a2blog_main.js" type="text/javascript"&gt;&lt;/script&gt;</code> As a result, upon page load, an object named navBlog is instantiated: <code>var navBlog = new NavBlog();</code> Object instantiation, in turn, triggers the execution of the following code:</p>

<div class="ghgist" data-ghgistid="676ca9603f931893c9e5d692c156fc90"></div>

<p>The code above launches an asynchronous jQuery AJAX call in order to retrieve the most recent information about my blog's content in <a href="https://hdr.is-a-geek.com/blog/idx" title="Content of my blog">JSON format</a>. This data is then assigned to navBlog's private object property blogJSON for easy access. Next the value of query string parameter "content" is determined. Query string parameter "content" controls the content which is loaded when the HTML page is first delivered. Variable currIdx is then set to the index value of array blogJSON for which the property "file" matches the loaded content.</p>

<p>From this point on state is basically controlled on the client-side through the value of navBlog's current index (i.e. variable currIdx). I therefore use, as a final statement in the code listed above, the method replaceState on the history object to keep track of state so it can be reconstructed in case the user navigates either backwards or forwards.</p>

<p><img src="./assets/imgs/hist_state_prop.png" alt="History state property"></p>

<p>The history object is <a href="https://caniuse.com/#feat=history" title="Session history management">supported</a> by most modern browsers. Please note that this topic is continued in this blog's <a class="blog_next" href="./next" title="Next blog post">next post</a>.</p>
